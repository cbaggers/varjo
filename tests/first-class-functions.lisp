(in-package :varjo.tests)
(5am:in-suite first-class-func-tests)

;;------------------------------------------------------------
;; Helper data

(varjo:add-external-function
 'ext-int-fncaller '((fn (function (:int) :int)) (ham :int)) nil
 `((funcall fn ham)))

(varjo:add-external-function
 'ext-return-int '() nil
 `(10))

(varjo:v-def-glsl-template-fun foop (&rest a) "foop(狺蕃)"
                               (&rest :float) :int)

(varjo:v-def-glsl-template-fun foop (&rest a) "ifoop(狺蕃)"
                               (&rest :int) :int)

(varjo:v-def-glsl-template-fun boop (a &rest b) "boop(a狺ê骒镝蝈篝烘祜狒洪铘鲠蜿锖霏溴姝珈箪翦眇灬翦骢怙镳ㄡ蝈篝猢⑩镲皎狺狺ê轭蝈篝洪铘洪铘换换藻篝ǖ犴轰彐翦篝姝悱骢钽ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬ㄦ轭轶桢蟓ㄣ镯痖戾鲥螋ī捍卑铋戾è骖灬忮祗è翦篝è洪铘┅┅＇翦篝┅觥癌┅┅ǖ犴轰彐翦篝姝悱骢钽ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬ㄦ轭轶桢蟓ㄣ镯痖戾鲥螋ī捍卑铋戾è骖灬忮祗è翦篝è洪铘┅┅＇翦篝┅ㄦ躅汜祆骖卑觥癌┅┅ǖ犴轰彐翦篝姝悱骢钽ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬ㄧ祗飙滹弩铘泔铘衢瞽⑵位ㄣ镯痖戾鲥螋ī捍卑铋戾è骖灬忮祗è翦篝è洪铘┅┅＇翦篝┅骖觥癌┅┅ǖ犴轰彐翦篝姝悱骢钽ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬ㄧ祗飙滹弩铘泔铘衢瞽⑵位ㄣ镯痖戾鲥螋ī捍卑铋戾è骖灬忮祗è翦篝è洪铘┅┅＇翦篝┅灬忮祗è骘è骀ㄦ躅泗轱ê轭舂洪铘┅ㄦ躅汜祆骀卑┅ㄦ镲骖┅觥癌┅┅ǖ犴轰彐翦篝姝悱骢钽ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬箝珙犰鲠蜿锃泔钿轸轱铙恒祜篚蝈蟓铒舡篚痧矧翦ㄣ镯痖戾鲥螋ī捍卑铋戾舄è卑ㄦ灬忮祗è翦篝è洪铘┅í┅＇翦篝┅觥癌┅┅ǖ犴轰彐翦篝姝悱骢钽ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬箝珙犰鲠蜿锃泔钿轸轱铙恒蝻篌筱镳瀛眭翎翦ㄣ镯痖戾鲥螋ī捍卑铋戾舄è卑ㄦ灬忮祗è翦篝è洪铘┅箦翩博┅＇翦篝┅ㄦ躅汜祆骖卑觥癌┅┅ǖ犴轰彐翦篝姝悱骢钽ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬箝珙犰鲠蜿锃泔钿轸轱铙恒蝻篌筱镳瀛眭翎翦ㄣ镯痖戾鲥螋ī捍卑铋戾舄è卑ㄦ灬忮祗è翦篝è洪铘┅┅＇翦篝┅灬忮祗è骘è骀ㄦ躅泗轱ê轭舂洪铘┅箦翩博ㄦ躅汜祆骀卑┅ㄦ镲骖┅觥癌┅┅ǖ犴轰彐翦篝姝悱骢钽ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬箝珙犰鲠蜿锃泔钿轸轱铙后礅镬躅殇孱糸骈邃ㄣ镯痖戾鲥螋ī捍卑铋灬忮祗è骘è骀ㄦ躅泗轱ê轭舂洪铘┅ㄦ躅汜祆骀┅戾è卑┅ㄦ镲灬礅溽è洪铘┅岍┅觥癌┅ǖ犴轰彐翦篝姝悱骢钽ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬ㄦ轭轶桢蟓ㄣ镯痖戾鲥螋ī捍卑铋戾è骖灬忮祗è翦篝è洪铘┅┅＇翦篝┅灬忮祗è骘è骀ㄦ躅泗轱ê轭舂洪铘┅ㄦ躅汜祆骀卑┅ㄦ镲骖┅觥癌┅┅ǖ犴轰彐翦篝姝悱骢钽ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬ㄦ轭轶桢蟓ㄣ镯痖戾鲥螋è洪铘┅捍卑铋戾è暴ㄦ灬礅溽ī灬礅溽è烘祜狒┅í博┅┅觥ㄦ躅汜祆ㄦ躅汜祆骖┅┅┅ǖ犴轰彐翦篝姝悱骢钽卑ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬ㄦ轭轶桢蟓ㄣ镯痖戾鲥螋è洪铘┅捍卑铋戾è暴灬忮祗è骖è翳ㄦ躅泗轱ê骒镝舂烘祜狒┅洪铘┅ǐ畅翳颟觥ㄦ躅汜祆ㄦ灬礅溽è烘祜狒┅í博卑┅┅┅ǖ犴轰彐翦篝姝悱骢钽北ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬ㄦ轭轶桢蟓ㄣ镯痖戾鲥螋è洪铘┅捍卑铋灬忮祗è骖è洪铘┅í┅ㄥ舡轭舡骖汜祆弪＇骖卑觥癌┅┅ǖ犴轰彐翦篝姝悱骢钽辈ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬ㄦ轭轶桢蟓ㄣ镯痖戾鲥螋ī捍卑铋戾è卑ㄦ＇箝瞟ㄦ躅汜祆骖卑觥穿┅┅ǖ犴轰彐翦篝姝悱骢钽背ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬ㄦ轭轶桢蟓ㄣ镯痖戾鲥螋ī捍卑铋ㄦ戾è箫礤骢钽è骖ㄦ躅泗轱ê骒镝舂烘祜狒┅ㄦ躅汜祆骖卑蟀┅戾è骖＇箝瞟箫礤骢钽骖觥穿┅┅ǖ犴轰彐翦篝姝悱骢钽贝ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬ㄦ轭轶桢蟓ㄣ镯痖戾鲥螋ī捍卑铋戾è骖＇屮舡蝈趱蝾轭舂觥癌┅┅ǖ犴轰彐翦篝姝悱骢钽钡ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬ㄦ轭轶桢蟓ㄣ镯痖戾鲥螋ī捍卑铋ㄩ卑＇箝＇ㄣ矬烘祜狒┅觥癌┅ǖ犴轰彐翦篝姝悱骢钽倍ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬ㄧ祗飙泔铘衢铙杯镦犰飙á鲲殇莆苘ㄩ铘乇苘┗㈡祜狒掏履淋塄骒镝匕苘┗ㄣ镯痖戾鲥螋è洪铘┅捍卑铋戾è暴灬忮祗è骖è翳ㄦ躅泗轱ê骒镝舂烘祜狒┅洪铘┅ǐ畅翳颟觥ㄦ躅汜祆ㄦ灬礅溽è烘祜狒┅í博卑┅┅┅ǖ犴轰彐翦篝姝悱骢钽狈ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬换翳轶铄邃铄栾礤滹弩铘忮祜铉轭翳轶篚轸ㄦ轭轶桢蟓瓠铒翦篝泔眇殪ㄣ镯痖戾鲥螋ī捍卑铋ㄦ镲暴ㄦ镲暴ㄦ镲畅ㄦ镲畅觥穿┅ǖ犴轰彐翦篝姝悱骢钽备ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬换翳轶铄邃铄栾礤滹弩铘忮祜铉轭翳轶篚轸ㄦ轭轶桢蟓瓠铒翦篝泔眇殪ㄣ镯痖戾鲥螋ī捍卑铋ㄢ镲暴ㄢ镲暴ㄢ镲畅ㄢ镲畅觥穿┅ǖ犴轰彐翦篝姝悱骢钽惫ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬ㄦ轭轶桢蟓瓠铒翦篝泔眇殪ㄣ镯痖戾鲥螋ī捍卑铋戾è骖＇ㄦ镲洪铘┅ㄦ畋＇ㄢ镲洪铘洪铘┅ㄦ躅汜祆骖暴ㄦ躅汜祆骖博觥穿┅ǖ犴轰彐翦篝姝悱骢钽舶ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬ㄦ轭轶桢蟓瓠铒翦篝泔眇殪ㄣ镯痖戾鲥螋ī捍卑铋戾è骖＇ㄦ镲洪铘┅ㄦ畋＇ㄢ镲洪铘洪铘┅ㄦ躅汜祆骖暴ㄦ躅汜祆骖博觥穿┅ǖ犴轰彐翦篝姝悱骢钽脖ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬ㄦ轭轶桢蟓瓠铒翦篝泔眇殪ㄣ镯痖戾鲥螋ī捍卑铋戾è骖＇骘镳┅ㄦ躅汜祆骖暴ㄦ躅汜祆骖碑伯钞串诞懂樊癌ㄦ躅汜祆骖碑卑┅觥穿┅ǖ犴轰彐翦篝姝悱骢钽膊ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬箝珙犰鲠蜿锃泔钿轸轱铙恒犷铒舡翎脲蝈驽蝈钽瀛麸蝈篝骢钽ㄣ镯痖戾鲥螋ī捍卑铋戾è骖＇ㄦ镲蝈篝洪铘┅ㄦ躅汜祆骖暴觥穿┅ǖ犴轰彐翦篝姝悱骢钽渤ê篚轸骈蝮舡沆狍蟓骢钽翦篝螬箝珙犰鲠蜿锃泔钿轸轱铙侯锃鲠扉洵骢钽糸镱ㄣ镯痖戾鲥螋ī捍卑铋戾è骖＇ㄦ镲洪铘┅ㄦ畋＇ㄢ镲洪铘洪铘┅ㄦ躅汜祆骖博ㄦ躅汜祆骖暴觥穿┅